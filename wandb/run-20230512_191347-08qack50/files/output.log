Starting supervised experiment data/supervised/0/: --seed 0 --device cpu
{'act_fn': <pypc.utils.ReLU object at 0x7f7fd004fc10>,
 'batch_scale': False,
 'batch_size': 64,
 'fixed_preds_train': True,
 'grad_clip': 50,
 'kaiming_init': False,
 'label_scale': None,
 'log_every': 100,
 'logdir': 'data/supervised/0/',
 'lr': 0.0001,
 'mu_dt': 0.01,
 'n_epochs': 30,
 'n_train_iters': 50,
 'nodes': [1024, 640, 200, 10],
 'normalize': False,
 'optim': 'Adam',
 'seed': 0,
 'seeds': [0],
 'test_every': 1,
 'test_size': None,
 'train_size': None,
 'use_bias': True,
 'weight_decay': None}
Files already downloaded and verified
Files already downloaded and verified
Traceback (most recent call last):
  File "/Users/tinym/opt/anaconda3/envs/predcod/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/Users/tinym/opt/anaconda3/envs/predcod/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/Users/tinym/Desktop/pypc/scripts/supervised.py", line 134, in <module>
    main(cf)
  File "/Users/tinym/Desktop/pypc/scripts/supervised.py", line 34, in main
    train_loader = datasets.get_dataloader(train_dataset, cf.batch_size)
  File "/Users/tinym/Desktop/pypc/pypc/datasets.py", line 131, in get_dataloader
    return list(map(_preprocess_batch, dataloader))
  File "/Users/tinym/opt/anaconda3/envs/predcod/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/Users/tinym/opt/anaconda3/envs/predcod/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/Users/tinym/opt/anaconda3/envs/predcod/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/Users/tinym/opt/anaconda3/envs/predcod/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/Users/tinym/Desktop/pypc/pypc/datasets.py", line 74, in __getitem__
    data = np.array([cv2.cvtColor(image, cv2.COLOR_BGR2GRAY) for image in data])
  File "/Users/tinym/Desktop/pypc/pypc/datasets.py", line 74, in <listcomp>
    data = np.array([cv2.cvtColor(image, cv2.COLOR_BGR2GRAY) for image in data])
cv2.error: OpenCV(4.7.0) :-1: error: (-5:Bad argument) in function 'cvtColor'
> Overload resolution failed:
>  - src is not a numpy array, neither a scalar
>  - Expected Ptr<cv::UMat> for argument 'src'